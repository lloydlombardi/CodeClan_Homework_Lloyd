---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(CodeClanData)
```

```{r}
revenue <- qb_revenue_breakdown %>% janitor::clean_names()

sales <- qb_monthly_sales  %>% janitor::clean_names()

competitors <- qb_competitors %>% janitor::clean_names()

device <- qb_device_data %>% janitor::clean_names()

```


# 1. Take the data in the dataset qb_revenue_breakdown and make a stacked bar chart showing the sources of revenue across the two years in the dataset.
```{r}
revenue %>% 
  ggplot(aes(x = year,
             y = revenue,
             fill = product)) +
  geom_col() +
  labs(x = "\nYear",
       y = "Revenue ($)",
       title = "2018/19 Product Revenue",
       subtitle = "Breakdown by product\n",
       fill = "Product") 
```

# 2. Make a line chart showing monthly sales of the “flagship product” - the ‘KwikBit Unit 1’ - over the last year.
```{r}
kb_unit_1 <- sales %>% 
  filter(cashflow == "Kwikbit Unit 1 Sales")

kb_unit_1 %>% 
  ggplot(aes(x = date,
             y = amount)) +
  geom_line() +
   labs(x = "\nDate",
       y = "Sales ($)",
       title = "Monthly Sales of KwikBit Unit 1\n") 
```


# 3. Make a line chart showing monthly revenue and costs over the last year. This data is also in qb_monthly_sales.
```{r}
sales_and_revenue <- sales %>% 
  filter(cashflow != "Kwikbit Unit 1 Sales")

sales_and_revenue %>% 
  ggplot(aes(x = date,
             y = amount,
             group = cashflow,
             colour = cashflow)) +
  geom_line() +
  facet_wrap(~ cashflow,
             nrow = 1,
             scales = "free_y") +
  labs(x = "\nDate",
       y = "Amount ($)",
       title = "Monthly Cost vs Revenue\n")
```

# 4. Show annual sales of personal fitness trackers over the last 5 years broken down by company as a ribbon plot (use geom_area). 

```{r}
competitors %>% 
  ggplot(aes(x = year,
             y = revenue,
             fill = company)) +
  geom_area() +
    labs(x = "\nYear",
       y = "Revenue ($)",
       title = "Annual Competitor Sales\n",
       fill = "Competitors")
```

# 5. Now show the sales from the four competitors as a line graph. Include an extra layer that shows the data points used to make the lines.
```{r}
competitors %>% 
  ggplot(aes(x = year,
             y = revenue,
             group = company,
             colour = company)) +
  geom_line() + 
  geom_point() +
  labs(x = "\nYear",
       y = "Revenue ($)",
       title = "Annual Competitor Sales\n",
       colour = "Competitors")
```

```{r}
view(device)
```



# 6. Now the company wants to compare the number of steps that their device counts vs. their competitors. Make a line graph of the number of steps throughout time, and use faceting to compare between companies and people.


```{r}
person_1 <- device %>% 
  filter(id == "person1")

person_1 %>%
  ggplot(aes(x = hours,
              y = counts,
              group = device,
              colour = device)) +
  geom_line() +
  facet_wrap(id ~ device) +
  labs(x = "\nHours",
       y = "Step Count",
       title = "Person 1 Device Comparison\n",
       colour = "Devices")
```


```{r}
person_2 <- device %>% 
  filter(id == "person2")

person_2 %>%
  ggplot(aes(x = hours,
              y = counts,
              group = device,
              colour = device)) +
  geom_line() +
  facet_wrap(id ~ device) +
  labs(x = "\nHours",
       y = "Step Count",
       title = "Person 2 Device Comparison\n",
       colour = "Devices")
```


```{r}
person_3 <- device %>% 
  filter(id == "person3")

person_3 %>%
  ggplot(aes(x = hours,
              y = counts,
              group = device,
              colour = device)) +
  geom_line() +
  facet_wrap(id ~ device) +
  labs(x = "\nHours",
       y = "Step Count",
       title = "Person 3 Device Comparison\n",
       colour = "Devices")
```


```{r}
person_4 <- device %>% 
  filter(id == "person4")

person_4 %>%
  ggplot(aes(x = hours,
              y = counts,
              group = device,
              colour = device)) +
  geom_line() +
  facet_wrap(id ~ device) +
  labs(x = "\nHours",
       y = "Step Count",
       title = "Person 4 Device Comparison\n",
       colour = "Devices")
```


```{r}
person_5 <- device %>% 
  filter(id == "person5")

person_5 %>%
  ggplot(aes(x = hours,
              y = counts,
              group = device,
              colour = device)) +
  geom_line() +
  facet_wrap(id ~ device) +
  labs(x = "\nHours",
       y = "Step Count",
       title = "Person 5 Device Comparison\n",
       colour = "Devices")
```



```{r}
col_scheme <- c("#E89FE9", "#50434F", "#B6A7B5", "#F9A472", "#BD7040")

my_theme <- theme(
    text = element_text(size = 12),
    title = element_text(size = 14),
    axis.text = element_text(size = 10),
    panel.background = element_rect(fill = "white"),
    panel.grid = element_line(colour = "grey90", linetype = "dashed")
  )
```


```{r}
revenue %>% 
  ggplot(aes(x = year,
             y = revenue,
             fill = product)) +
  geom_col() +
  labs(x = "\nYear",
       y = "Revenue ($)",
       title = "2018/19 Product Revenue",
       subtitle = "Breakdown by product\n",
       fill = "Product") +
  scale_fill_manual(values = col_scheme) +
  my_theme

```


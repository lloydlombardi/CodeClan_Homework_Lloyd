---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(CodeClanData)
library(gghighlight)
```

# 1. Load in the libraries you need, and look at the backpack data. Take note of variable names and dimensions.
```{r}
backpack
```

# 2. What is the distribution of backpack weights that students are carrying? Choose an appropriate graph to show the distribution.
```{r}
backpack %>% 
  ggplot(aes(x = backpack_weight,
             fill = backpack_weight == 10)) +
  geom_histogram(binwidth = 1, col = "white") +
  scale_fill_manual(values = c("lightblue", "red"), guide = "none") +
  labs(x = "\nBackpack Weight (lbs)",
       y = "Count",
       title = "Distribution of Backpack Weights\n")
```
The above histogram was rendered to show the distribution of weight that students were carrying in their backpacks
The binwidth was chosen as 1 so that there were increments of 1kg between the backpack weights that were counted
It can clearlt be seen that 1lb is the most frequent backpack weight, with 12 students having bags of this weight
The lightest back was 2lbs
The heaviest bag was 35lbs, 10lbs heavier than the second heaviest bag


# 3. Are there differences in backpack weight between sex?
```{r}
backpack %>% 
  ggplot(aes(x = backpack_weight,
             fill = backpack_weight)) +
  geom_histogram(binwidth = 1, col = "white") +
  facet_wrap(~ sex) +
  labs(x = "\nBackpack Weight (lbs)",
       y = "Count",
       title = "Distribution of Backpack Weights\n") +
  theme_bw()
```
The histogram from question 3 was faceted to show the distribution between males and females
It can be see that the most common weight overall of 10lbs is the most common weight for females
Interestingly, there are only 2 males whose backpacks were this weight. Instead the most common weight was 11lbs



# 4. What is the relationship between body weight and backpack weight?
```{r}
backpack %>% 
  ggplot(aes(x = body_weight,
             y = backpack_weight)) +
  geom_point() +
  geom_smooth() +
    labs(x = "\nBody Weight (lbs)",
       y = "Backpack Weight (lbs)",
       title = "Relationship between Body Weight and Backpack Weights\n") 
```
A scatter plot was created to investigate any correlation between body weight and backpack weight
The graph shows that there is a slight increase in backpack weight as the body weight increases, up until the 200lbs body weight
The majority of backpack weights are between 5-10lbs and most of the body weight is between 125-175lbs
There are some large outliters, such as a backpack weight of 35lbs and a bodyweight of around 280lbs
There is no correlation between the heaviest body weights and the heaviest bags


# 5. Is this relationship different between men and women? Choose an appropriate plot and interpret your findings.
```{r}
backpack %>% 
  ggplot(aes(x = body_weight,
             y = backpack_weight)) +
  geom_point(aes(colour = sex)) +
   labs(x = "\nBody Weight (lbs)",
       y = "Backpack Weight (lbs)",
       title = "Relationship between Body Weight and Backpack Weights by Female v Male\n",
       colour = "Sex") +
  theme_linedraw()
```
The scatter plot from Q4 was run again, this time accounting for the sex of the student
There is a clear distinction in bodyweight between the Male and Female students
Interestingly, the back pack weights that each sex carries is evenly distributed, with 2/3 of the second heaviest backpack weights being carried by females.
The heaviest bag, however, is carried by a Male


# 6. What proportion of students report back pain?
```{r}
bar_plot_data <- backpack %>%
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  group_by(back_problems) %>% 
  summarise(count = n())
  

bar_plot <- bar_plot_data %>%   
  ggplot(aes(x = "",
             y = count,
             fill = back_problems)) +
  geom_bar(width = 1, stat = "identity") +
   labs(x = "",
       y = "Percentage of students",
       title = "Percentage of students with backpain\n",
       fill = "Back Problems") 

pie <- bar_plot +
  geom_text(aes(label = paste0(count / sum(count) * 100, "%")), size = 5, y = c(75, 15)) +
  coord_polar(theta = "y", start = 0) +
  scale_fill_brewer(palette = "Dark2") +
  theme_void() 
pie
```
A pie chart was created to find the proportion of students that have back pain
It can be seen that around 1/3 of students reported back pain




# 7. Is this proportion different between men and women?
```{r}
bar_plot_male_data <- backpack %>%
  filter(sex == "Male") %>% 
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  group_by(back_problems) %>% 
  summarise(count = n()) %>%
  mutate(across(.cols = where(is.numeric), .fns = ~count/45 * 100))

bar_plot_male <- bar_plot_male_data %>% 
  ggplot(aes(x = "",
             y = count,
             fill = back_problems)) +
  geom_bar(width = 1, stat = "identity") +
   labs(x = "",
       y = "Percentage of males",
       title = "Percentage of males with backpain\n",
       fill = "Back Problems") 


pie_male <- bar_plot_male +
  geom_text(aes(label = paste0(round(count / sum(count) * 100), "%")), size = 5, y = c(90, 10)) +
  coord_polar(theta = "y", start = 0) +
  scale_fill_brewer(palette = "Dark2") +
  theme_void() 
pie_male


bar_plot_female <- backpack %>%
  filter(sex == "Female") %>% 
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  group_by(back_problems) %>% 
  summarise(count = n()) %>%
  mutate(across(.cols = where(is.numeric), .fns = ~count/55 * 100)) %>% 
  ggplot(aes(x = "",
             y = count,
             fill = back_problems)) +
  geom_bar(width = 1, stat = "identity") +
   labs(x = "",
       y = "Percentage of females",
       title = "Percentage of females with backpain\n",
       fill = "Back Problems") 


pie_female <- bar_plot_female +
  coord_polar(theta = "y", start = 0)
pie_female
```
2 more pie charts were created to find the difference in percentage between males and females that reported back pain
It can be seen that there is a large disparity between the sexes
Less than 25% of Males reported back pain whilst over 40% of Females reported backpain



# 8. Now youâ€™ve investigated your data separately, create plots to describe the relationship between backpack weight, body weight, gender and reported backpain.


```{r}
relationship_plot <- backpack %>%
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  ggplot(aes(x = body_weight,
             y = backpack_weight,
             shape = back_problems)) +
  geom_point(aes(colour = sex)) +
   labs(x = "\nBody Weight (lbs)",
       y = "Backpack Weight (lbs)",
       title = "Relationship between Body Weight, Backpack Weights and Back Problems\nby Female v Male\n",
       colour = "Sex",
       shape = "Back Problems") +
  theme_linedraw()

relationship_plot
```
A scatter plot with different shapes and colour was used to plot the correlation between bodyweight, backpack weight, back problems and gender

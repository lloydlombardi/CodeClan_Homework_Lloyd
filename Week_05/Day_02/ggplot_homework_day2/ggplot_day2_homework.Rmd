---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(CodeClanData)
library(gghighlight)
```

# 1. Load in the libraries you need, and look at the backpack data. Take note of variable names and dimensions.
```{r}
backpack
```

# 2. What is the distribution of backpack weights that students are carrying? Choose an appropriate graph to show the distribution.
```{r}
backpack %>% 
  ggplot(aes(x = backpack_weight,
             fill = backpack_weight == 10)) +
  geom_histogram(binwidth = 1, col = "white") +
  scale_fill_manual(values = c("lightblue", "red"), guide = "none") +
  labs(x = "\nBackpack Weight",
       y = "Count",
       title = "Distribution of Backpack Weights\n")
```
The above histogram was rendered to show the distribution of weight that students were carrying in their backpacks
The binwidth was chosen as 1 so that there were increments of 1kg between the backpack weights that were counted
It can clearlt be seen that 10kg is the most frequent backpack weight, with 12 students having bags of this weight
The lightest back was 2kg
The heaviest bag was 35kg, 10kg heavier than the second heaviest bag


# 3. Are there differences in backpack weight between sex?
```{r}
backpack %>% 
  ggplot(aes(x = backpack_weight,
             fill = backpack_weight)) +
  geom_histogram(binwidth = 1, col = "white") +
  facet_wrap(~ sex) +
  labs(x = "\nBackpack Weight",
       y = "Count",
       title = "Distribution of Backpack Weights\n") +
  theme_bw()
```
The histogram from question 3 was faceted to show the distribution between males and females
It can be see that the most common weight overall of 10kg is the most common weight for females
Interestingly, there are only 2 males whose backpacks were this weight. Instead the most common weight was 11kg






# 4. What is the relationship between body weight and backpack weight?
```{r}
backpack %>% 
  ggplot(aes(x = body_weight,
             y = backpack_weight)) +
  geom_point() +
  geom_smooth()
```


# 5. Is this relationship different between men and women? Choose an appropriate plot and interpret your findings.
```{r}
backpack %>% 
  ggplot(aes(x = body_weight,
             y = backpack_weight)) +
  geom_point(aes(colour = sex))
```



# 6. What proportion of students report back pain?
```{r}
bar_plot <- backpack %>%
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  group_by(back_problems) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = "",
             y = count,
             fill = back_problems)) +
  geom_bar(width = 1, stat = "identity")

pie <- bar_plot +
  coord_polar("y", start = 0) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal()
pie
```


# 7. Is this proportion different between men and women?
```{r}
bar_plot_male <- backpack %>%
  filter(sex == "Male") %>% 
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  group_by(back_problems) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = "",
             y = count,
             fill = back_problems)) +
  geom_bar(width = 1, stat = "identity")

pie_male <- bar_plot_male +
  coord_polar("y", start = 0)
pie_male


bar_plot_female <- backpack %>%
  filter(sex == "Female") %>% 
  mutate(back_problems = as.character(back_problems)) %>% 
  mutate(back_problems = recode(back_problems,
                                "1" = "Yes",
                                "0" = "No")) %>% 
  mutate(back_problems = as.factor(back_problems)) %>% 
  group_by(back_problems) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = "",
             y = count,
             fill = back_problems)) +
  geom_bar(width = 1, stat = "identity")

pie_female <- bar_plot_female +
  coord_polar("y", start = 0)
pie_female
```


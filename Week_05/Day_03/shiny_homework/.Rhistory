filter(year_found > 1800 & year_found < 1850) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
scale_y_log10() +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > 1800 & year_found < 1850) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_log10() +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > 1800 & year_found < 1850) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
source("~/CodeClan Work/CodeClan_Homework_Lloyd/Week_05/Day_03/shiny_homework/whisky_ggplots.Rmd")
source("~/CodeClan Work/CodeClan_Homework_Lloyd/Week_05/Day_03/shiny_homework/whisky_ggplots.Rmd")
source("~/CodeClan Work/CodeClan_Homework_Lloyd/Week_05/Day_03/shiny_homework/whisky_ggplots.Rmd")
source("~/CodeClan Work/CodeClan_Homework_Lloyd/Week_05/Day_03/shiny_homework/whisky.Rmd")
source("~/CodeClan Work/CodeClan_Homework_Lloyd/Week_05/Day_03/shiny_homework/whisky.Rmd")
library(shiny); runApp('whisky_app.R')
library(tidyverse)
library(janitor)
library(CodeClanData)
library(fmsb)
whisky <- CodeClanData::whisky %>% clean_names()
whisky %>%
distinct(distillery)
whisky %>%
distinct(region)
whisky %>%
distinct(owner)
whisky %>%
distinct(floral)
whisky <- whisky %>%
mutate(across(body:floral, as.numeric))
whisky <- whisky %>%
pivot_longer(cols = body:floral,
names_to = "notes",
values_to = "score")
whisky %>%
filter(distillery == "Aberfeldy") %>%
ggplot(aes(x = notes,
y = score,
fill = region)) +
geom_col() +
scale_y_continuous(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 4)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14)) +
labs(x = "Notes",
y = "\nScore",
fill = "Whisky Region")
all_regions <- unique(whisky$region)
all_distilleries <- unique(whisky$distillery)
whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found == 1810) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
runApp('whisky_app.R')
runApp('whisky_app.R')
whisky
whisky %>%
group_by(year_found) %>%
whisky %>%
group_by(year_found) %>%
summarise(count = n())
whisky %>%
group_by(year_found) %>%
summarise(count = n()) %>%
arrange(desc(count))
runApp('whisky_app.R')
runApp('whisky_app.R')
library(plotly)
runApp('whisky_app.R')
runApp('whisky_app.R')
library(shiny)
library(tidyverse)
library(bslib)
library(CodeClanData)
library(janitor)
library(plotly)
# wrangling ---------------------------------------------------------------
whisky <- CodeClanData::whisky %>% clean_names()
whisky <- whisky %>%
pivot_longer(cols = body:floral,
names_to = "notes",
values_to = "score")
all_regions <- unique(whisky$region)
all_distilleries <- unique(whisky$distillery)
all_regions
all_distilleries
install.packages("shinyWidgets")
library(shinyWidgets)
min_year <- min(whisky$year_found)
max_year <- max(whisky$year_found)
runApp('whisky_app.R')
library(tidyverse)
library(janitor)
library(CodeClanData)
library(fmsb)
whisky <- CodeClanData::whisky %>% clean_names()
whisky %>%
distinct(distillery)
whisky %>%
distinct(region)
whisky %>%
distinct(owner)
whisky %>%
distinct(floral)
whisky <- whisky %>%
mutate(across(body:floral, as.numeric))
whisky <- whisky %>%
pivot_longer(cols = body:floral,
names_to = "notes",
values_to = "score")
whisky %>%
filter(distillery == "Aberfeldy") %>%
ggplot(aes(x = notes,
y = score,
fill = region)) +
geom_col() +
scale_y_continuous(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 4)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14)) +
labs(x = "Notes",
y = "\nScore",
fill = "Whisky Region")
p <- whisky %>%
filter(distillery == "Aberfeldy") %>%
ggplot(aes(x = notes,
y = score,
fill = region)) +
geom_col() +
scale_y_continuous(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 4)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14)) +
labs(x = "Notes",
y = "\nScore",
fill = "Whisky Region")
whisky %>%
filter(distillery == "Aberfeldy") %>%
ggplot(aes(x = notes,
y = score,
fill = region)) +
geom_col() +
scale_y_continuous(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 4)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14)) +
labs(x = "Notes",
y = "\nScore",
fill = "Whisky Region")
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found == 1810) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found == 1810) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
ggplotly(p)
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found == 1810)
p
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found == 1810) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
ggplotly(p)
runApp('whisky_app.R')
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > input$year_input[1] & year_found < input$year_input[2]) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region), size = 3) +
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14),
plot.title = element_text(size = 48)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > input$year_input[1] & year_found < input$year_input[2]) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region), size = 3) +
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14),
plot.title = element_text(size = 48)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > input$year_input[1] & year_found < input$year_input[2]) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region), size = 3) +
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14),
plot.title = element_text(size = 48)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found == 1810) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
ggplotly(p)
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > 1810 & year_found < 1840) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
ggplotly(p)
library(tidyverse)
library(janitor)
library(CodeClanData)
library(fmsb)
whisky <- CodeClanData::whisky %>% clean_names()
whisky %>%
distinct(distillery)
whisky %>%
distinct(region)
whisky %>%
distinct(owner)
whisky %>%
distinct(floral)
whisky <- whisky %>%
mutate(across(body:floral, as.numeric))
whisky <- whisky %>%
pivot_longer(cols = body:floral,
names_to = "notes",
values_to = "score")
whisky %>%
filter(distillery == "Aberfeldy") %>%
ggplot(aes(x = notes,
y = score,
fill = region)) +
geom_col() +
scale_y_continuous(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 4)) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.title = element_text(size = 20),
legend.text = element_text(size = 14)) +
labs(x = "Notes",
y = "\nScore",
fill = "Whisky Region")
all_regions <- unique(whisky$region)
all_distilleries <- unique(whisky$distillery)
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > 1810 & year_found < 1840) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
ggplotly(p)
install.packages("rsconnect")
install.packages("plotly")
p <- whisky %>%
group_by(owner) %>%
mutate(count = n()/12) %>%
ungroup() %>%
filter(count > 1) %>%
filter(year_found > 1810 & year_found < 1840) %>%
ggplot(aes(x = year_found,
y = capacity,
colour = owner)) +
geom_point(aes(shape = region)) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
plot.title = element_text(size = 8)) +
scale_y_continuous(labels = scales::comma) +
labs(x = "Year Founded",
y = "Capacity",
colour = "Distillery Owner",
title = "Distillery Capacity by Year Founed\n")
plotly::ggplotly(p)
library(shiny); runApp('whisky_app.R')
runApp('whisky_app.R')

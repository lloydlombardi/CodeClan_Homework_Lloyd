---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(gtools)
library(janitor)

titanic <- read_csv("data/titanic.csv")

source("prob.R")
```


```{r}
titanic %>% 
  distinct(class)
```

```{r}
titanic <- titanic %>% 
  mutate(class = recode(class,
                        "3rd" = "passenger",
                        "2nd" = "passenger",
                        "1st" = "passenger",
                        "engineering crew" = "crew",
                        "victualling crew" = "crew",
                        "restaurant staff" = "crew",
                        "deck crew" = "crew"))
```

```{r}
titanic <- titanic %>% 
  mutate(survived = recode(survived,
                           "no" = FALSE,
                           "yes" = TRUE))
```


```{r}
titanic %>% 
  tabyl(class, survived) %>% 
  adorn_totals(where = c("row", "col")) %>% 
  adorn_title()
```


```{r}
prob_crew_surv <- titanic %>% 
  filter(class == "crew" & survived) %>% 
  summarise(prob = n() / nrow(titanic))

prob_crew_surv
```
Of all passengers on board, 9.5% were crew members that survived


```{r}
prob_pass_surv <- titanic %>% 
  filter(class == "passenger" & survived) %>% 
  summarise(prob = n() / nrow(titanic))

prob_pass_surv
```
Of all passengers on board, 22.6% were passengers that survived


```{r}
prob_surv_given_crew <- titanic %>% 
  filter(class == "crew") %>% 
  summarise(prob = sum(survived) / n())

prob_surv_given_crew
```
23.7% of all crew members survived


```{r}
prob_surv_given_pass <- titanic %>% 
  filter(class == "passenger") %>% 
  summarise(prob = sum(survived) / n())

prob_surv_given_pass
```
38% of all passengers survived


# Question 1.
If I roll a six-sided dice once, what is the probability of getting a number less than 5?
```{r}
one_die <- rolldie(1) 

q1 <- one_die %>% 
  filter(X1 < 5) %>% 
  summarise(prob = n() / nrow(one_die))

q1
```


# Question 2.
How many outcomes are there in the sample space of an experiment in which we toss three dice?
```{r}
6 * 6 * 6
```


#Question 3.
In an experiment where we roll four dice:

- how many outcomes are in the event where the total of the four dice equals 5, 6 or 7)?
- what is the probability of this event?
- what assumptions do we apply in answering part ii?

```{r}
s <- rolldie(4)

s_5_to_7 <- s %>% 
  mutate(total = X1 + X2 + X3 + X4) %>% 
  filter(total %in% c(5, 6, 7)) %>% 
  summarise(prob = n() / nrow(s))

s_5_to_7
```


# Question 4.
Five chairs are placed in a row in a room, along with five people of differing height. The people sit down randomly on the chairs. What is the probability that they sit in order of decreasing height, left to right?

```{r}
people <- c("Tallest", "Second Tallest", "Middle", "Second Shortest", "Shortest")

seating <- as_tibble(permutations(n = 5, r = 5, v = people, repeats.allowed = FALSE))

seating <- seating %>% 
  rename(seat_1 = V1, seat_2 = V2, seat_3 = V3, seat_4 = V4, seat_5 = V5)

height_order <- seating %>% 
  filter(seat_1 == "Tallest", seat_2 == "Second Tallest", seat_3 == "Middle", seat_4 == "Second Shortest", seat_5 == "Shortest") %>% 
  summarise(prob = n()/ nrow(seating))

height_order
```


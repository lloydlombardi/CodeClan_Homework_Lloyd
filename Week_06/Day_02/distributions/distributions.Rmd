---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(janitor)
library(skimr)
```


```{r}
mobiles <- read_csv("data/20190928-items.csv") %>% clean_names()
```

```{r}
mobiles %>% 
  distinct(brand)
```

```{r}
mobiles %>% 
  ggplot(aes(x = rating)) +
  geom_histogram(col = "white")
```


# Question 2.
Find the brand with the highest numbers of phones in the dataset.
```{r}
mobiles %>% 
  group_by(brand) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))
```



```{r}
samsung_mobile <- mobiles %>% 
  filter(brand == "Samsung")
```



# Question 3. 
For your top brand, plot the distribution of phone ratings as a probability density, overlaying a fitted normal distribution. Do you think the normal distribution provides a good model of these ratings?
```{r}
mobiles %>% 
  filter(brand == "Samsung") %>%
  select(rating) %>% 
  skim()
```


```{r}
samsung_stats <- mobiles %>% 
  filter(brand == "Samsung") %>%
  group_by(brand) %>% 
  summarise(mean_rating = mean(rating),
            sd_rating = sd(rating))

samsung_stats
```


```{r}
mobiles %>% 
  filter(brand == "Samsung") %>% 
  ggplot(aes(x = rating)) +
  geom_histogram(aes(y = ..density..), col = "white") +
  stat_function(
    fun = ~dnorm(.,
                 mean = samsung_stats$mean_rating,
                 sd = samsung_stats$sd_rating),
    col = "red"
  )
```


# Question 4.
We can be more quantitative in comparing the distribution of top brand ratings with a normal distribution. You calculated the mean() and sd() of your distribution in an earlier question. Use these values to calculate the proportions of ratings within one-, two- and three standard deviations of the mean. Compare these proportions with those you expect for a normal distribution.


```{r}
samsung_mobile %>% 
  filter(rating >= samsung_stats$mean_rating - samsung_stats$sd_rating) %>% 
  filter(rating <= samsung_stats$mean_rating + samsung_stats$sd_rating) %>% 
  summarise(proportion_1_sd = n() / nrow(samsung_mobile))

samsung_mobile %>% 
  filter(rating >= samsung_stats$mean_rating - (2 * samsung_stats$sd_rating)) %>% 
  filter(rating <= samsung_stats$mean_rating + (2 * samsung_stats$sd_rating)) %>% 
  summarise(proportion_2_sd = n() / nrow(samsung_mobile))

samsung_mobile %>% 
  filter(rating >= samsung_stats$mean_rating - (3 * samsung_stats$sd_rating)) %>% 
  filter(rating <= samsung_stats$mean_rating + (3 * samsung_stats$sd_rating)) %>% 
  summarise(proportion_3_sd = n() / nrow(samsung_mobile))
```

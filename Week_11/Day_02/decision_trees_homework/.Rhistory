ggplot(aes(x = age,
y = survived)) +
geom_boxplot()
titanic_clean %>%
ggplot(aes(x = age_status,
y = survived)) +
geom_boxplot()
titanic_clean %>%
group_by(survived) %>%
summarise(count = n())
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n())
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
colour = age_status))+
geom_col()
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = age_status))+
geom_col()
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = age_status))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, sex) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = sex))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, pclass) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = pclass))+
geom_col(position = "dodge")
titanic_clean
library(rpart)
library(rpart.plot)
library(tidyverse)
library(GGally)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
# shuffle the data so class order isn't in order - need this for training/testing split later on
titanic_set <- titanic_set[shuffle_index, ]
titanic_set
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(survived),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
drop_na() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(survived),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
omit_na() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(survived),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
na.omit() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean
titanic_set
titanic_clean
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(survived),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
drop_na() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean
titanic_clean %>%
group_by(survived, pclass) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = pclass))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, embarked) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = embarked))+
geom_col(position = "dodge")
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
titanic_train
titanic_test
test_index
n_data
titanic_clean
library(janitor)
library(janitor)
titanic_test %>%
tabyl(survived)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
titanic_fit <- rpart(
formula = survived ~ .,
data = titanic_train,
method = "class"
)
titanic_fit
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
titanic_train
titanic_fit <- rpart(
formula = survived ~ .,
data = titanic_train,
method = "class"
)
titanic_fit
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
titanic_fit
titanic_train
library(rpart)
library(rpart.plot)
library(tidyverse)
library(tidyverse)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
# shuffle the data so class order isn't in order - need this for training/testing split later on
titanic_set <- titanic_set[shuffle_index, ]
titanic_clean <- titanic_set %>%
filter(survived %in% c(0,1)) %>%
# Convert to factor level
mutate(sex = as.factor(sex),
age_status = as.factor(if_else(age <= 16, "child", "adult")),
class = factor(pclass, levels = c(3,2,1), labels = c("Lower", "Middle", "Upper")),
survived_flag = factor(survived, levels = c(0,1), labels = c("No", "Yes")),
port_embarkation = as.factor(embarked)) %>%
select(sex, age_status, class, port_embarkation, sib_sp, parch, survived_flag) %>%
na.omit()
titanic_clean
library(rpart)
library(rpart.plot)
library(tidyverse)
library(GGally)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
# shuffle the data so class order isn't in order - need this for training/testing split later on
titanic_set <- titanic_set[shuffle_index, ]
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(pclass),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
drop_na() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean %>%
select(survived, everything()) %>%
ggpairs()
titanic_clean %>%
ggplot(aes(x = age,
y = survived)) +
geom_boxplot()
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = age_status))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = age_status))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, sex) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = sex))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, pclass) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = pclass))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, embarked) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = embarked))+
geom_col(position = "dodge")
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
titanic_fit <- rpart(
formula = survived ~ .,
data = titanic_train,
method = "class"
)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
titanic_fit <- rpart(
formula = survived ~ .,
data = titanic_train,
method = "class"
)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
type = 4,
extra = 101,
digits = 4)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
type = 4,
extra = 101,
digits = 4)
library(modelr)
titanic_test_pred <- titanic_test %>%
add_predictions(titanic_fit, type = "class")
titanic_test_pred
library(caret)
confusionMatrix(titanic_test_pred$pred,
titanic_test_pred$survived)
library(rpart)
library(rpart.plot)
library(tidyverse)
library(GGally)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
# shuffle the data so class order isn't in order - need this for training/testing split later on
titanic_set <- titanic_set[shuffle_index, ]
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(pclass),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
drop_na() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean
library(rpart)
library(rpart.plot)
library(tidyverse)
library(GGally)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
# shuffle the data so class order isn't in order - need this for training/testing split later on
titanic_set <- titanic_set[shuffle_index, ]
titanic_clean <- titanic_set %>%
filter(survived %in% c(0,1)) %>%
# Convert to factor level
mutate(sex = as.factor(sex),
age_status = as.factor(if_else(age <= 16, "child", "adult")),
class = factor(pclass, levels = c(3,2,1), labels = c("Lower", "Middle", "Upper")),
survived_flag = factor(survived, levels = c(0,1), labels = c("No", "Yes")),
port_embarkation = as.factor(embarked)) %>%
select(sex, age_status, class, port_embarkation, sib_sp, parch, survived_flag) %>%
na.omit()
titanic_clean
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(pclass),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
drop_na() %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin))
titanic_clean
titanic_set %>%
filter(!is.na(survived))
titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(pclass),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult")))
titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(pclass),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
drop_na()
titanic_clean <- titanic_set %>%
filter(!is.na(survived)) %>%
mutate(sex = as.factor(sex),
survived = as.factor(survived),
pclass = as.factor(pclass),
embarked = as.factor(embarked)) %>%
mutate(age_status = as.factor(case_when(age <= 16 ~ "child",
TRUE ~ "adult"))) %>%
select(-c(...1, passenger_id, name, ticket, fare, cabin)) %>%
drop_na()
titanic_clean
titanic_clean %>%
select(survived, everything()) %>%
ggpairs()
titanic_clean %>%
ggplot(aes(x = age,
y = survived)) +
geom_boxplot()
titanic_clean %>%
group_by(survived, age_status) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = age_status))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, sex) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = sex))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, pclass) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = pclass))+
geom_col(position = "dodge")
titanic_clean %>%
group_by(survived, embarked) %>%
summarise(count = n()) %>%
ggplot(aes(x = survived,
y = count,
fill = embarked))+
geom_col(position = "dodge")
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data * 0.2)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test <- slice(titanic_clean, test_index)
library(janitor)
titanic_test %>%
tabyl(survived)
titanic_train %>%
tabyl(survived)
titanic_fit <- rpart(
formula = survived ~ .,
data = titanic_train,
method = "class"
)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
rpart.plot(titanic_fit,
yesno = 2,
fallen.leaves = TRUE,
type = 4,
extra = 101,
digits = 4)
titanic_fit
library(modelr)
titanic_test_pred <- titanic_test %>%
add_predictions(titanic_fit, type = "class")
titanic_test_pred
library(caret)
confusionMatrix(titanic_test_pred$pred,
titanic_test_pred$survived)

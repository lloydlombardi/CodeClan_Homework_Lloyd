library(tidyverse)
library(broom)
library(factoextra)
library(GGally)
mall <- read_csv("data/mall_customers.csv") %>% janitor::clean_names()
mall
mall_target <- mall %>%
select(annual_income_k, spending_score_1_100)
mall_target %>%
ggplot(aes(x = spending_score_1_100,
y = annual_income_k))+
geom_point()
mall_target %>%
ggplot(aes(x = annual_income_k,
y = spending_score_1_100))+
geom_point()
library(tidyverse)
library(broom)
library(factoextra)
library(GGally)
mall <- read_csv("data/mall_customers.csv") %>% janitor::clean_names()
mall_target <- mall %>%
select(annual_income_k, spending_score_1_100)
mall_target %>%
ggplot(aes(x = annual_income_k,
y = spending_score_1_100))+
geom_point()
max_k <- 20
k_clusters <- tibble(k = 1:max_k) %>%
mutate(
kclust = map(k, ~ kmeans(mall_target, .x, nstart = 25)),
tidied = map(kclust, tidy),
glanced = map(kclust, glance),
augmented = map(kclust, augment, mall_target)
)
clusterings_target <- k_clusters %>%
unnest(glanced)
clusterings_target %>%
ggplot(aes(x = k,
y = tot.withinss)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = seq(1, 20, 1))
library(factoextra)
library(factoextra)
fviz_nbclust(mall_target,
kmeans,
method = "silhouette",
nstart = 25)
fviz_nbclust(mall_target,
kmeans,
method = "gap_stat",
nstart = 25)
clusterings_target %>%
unnest(cols = c(augmented)) %>%
filter(k <= 5) %>%
ggplot(aes(x = annual_income_k,
y = spending_score_1_100)) +
geom_point(aes(colour = .cluster)) +
facet_wrap(~ k)
clusterings_target %>%
unnest(augmented) %>%
filter(k == 5) %>%
group_by(.cluster) %>%
summarise(mean(annual_income_k),
mean(spending_score_1_100))
library(tidyverse)
library(broom)
library(factoextra)
library(GGally)
mall <- read_csv("data/mall_customers.csv") %>% janitor::clean_names()
mall

library(tidyverse)
library(janitor)
library(lubridate)
library(plotly)
incidence <- read_csv("data/incidence_by_hb.csv")
hb <- read_csv("data/hb_geography_code.csv")
hb
incidence
incidence <- read_csv("data/incidence_by_hb.csv") %>% clean_names()
hb <- read_csv("data/hb_geography_code.csv") %>% clean_names()
incidence
hb
incidence_join <- incidence %>%
left_join(dplyr::select(hb, hb_name, hb), by = c("hb" = "hb"))
incidence_join
library(tidyverse)
library(janitor)
library(lubridate)
incidence <- read_csv("data/incidence_by_hb.csv") %>% clean_names()
hb <- read_csv("data/hb_geography_code.csv") %>% clean_names()
incidence <- incidence %>%
left_join(select(hb, hb_name, hb), by = c("hb" = "hb"))
incidence
incidence <- incidence %>%
left_join(select(hb, hb_name, hb), by = c("hb" = "hb"))
rm(incidence_join)
nhs_borders <- incidence %>%
filter(hb_name.x == "NHS Borders")
nhs_borders
?left_join
incidence <- read_csv("data/incidence_by_hb.csv") %>% clean_names()
hb <- read_csv("data/hb_geography_code.csv") %>% clean_names()
incidence <- incidence %>%
left_join(select(hb, hb_name, hb), by = c("hb" = "hb"), keep = FALSE)
nhs_borders <- incidence %>%
filter(hb_name.x == "NHS Borders")
nhs_borders <- incidence %>%
filter(hb_name == "NHS Borders")
nhs_borders
library(tidyverse)
library(janitor)
library(lubridate)
incidence <- read_csv("data/incidence_by_hb.csv") %>% clean_names()
hb <- read_csv("data/hb_geography_code.csv") %>% clean_names()
incidence <- incidence %>%
left_join(select(hb, hb_name, hb), by = c("hb" = "hb"), keep = FALSE)
nhs_borders <- incidence %>%
filter(hb_name == "NHS Borders")
nhs_borders
nhs_borders %>%
distinct(cancer_site)
nhs_borders
nhs_borders %>%
distinct(cancer_site)
nhs_borders %>%
distinct(cancer_site_icd10code)
nhs_borders
nhs_borders %>%
distinct(sex)
nhs_borders
nhs_borders %>%
filter(cancer_site == "All cancer types") %>%
group_by(year) %>%
summarise(count = n())
nhs_borders
nhs_borders %>%
filter(cancer_site == "All cancer types",
sex == "All")
nhs_borders %>%
filter(cancer_site == "All cancer types",
sex == "All") %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_col()
nhs_borders %>%
filter(cancer_site == "All cancer types",
sex == "All") %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line(group = 1)
nhs_borders %>%
filter(cancer_site == "All cancer types",
sex == "All") %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line(group = 1)+
geom_smooth()
incidence
incidence %>%
distinct(hb_name)
incidence
nhs_borders %>%
distinct(cancer_site)
nhs_borders %>%
distinct(cancer_site) %>%
arrange(cancer_site)
nhs_borders
nhs_borders %>%
distinct(cancer_site)
nhs_borders %>%
distinct(cancer_site) %>%
arrange(cancer_site)
nhs_borders %>%
filter(cancer_site %in% ("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer	", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"))
nhs_borders %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer	", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"))
nhs_borders_select <- nhs_borders %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung")) %>%
mutate(cancer_common = case_when(
str_detect(cancer_site, "Breast") ~ "Breast",
str_detect(cancer_site, "Carcinoma in situ of the breast") ~ "Breast",
str_detect(cancer_site, "Colon") ~ "Colon",
str_detect(cancer_site, "Colorectal cancer") ~ "Colon",
str_detect(cancer_site, "Rectum and rectosigmoid junction") ~ "Colon",
str_detect(cancer_site, "Prostate") ~ "Prostate",
str_detect(cancer_site, "Mesothelioma") ~ "Lung",
str_detect(cancer_site, "Trachea, bronchus and lung") ~ "Lung"
), .after = cancer_site)
nhs_borders_select
nhs_borders_select %>%
filter(cancer_common == "Prostate")
nhs_borders_select
nhs_borders_select %>%
select(sex %in% c("Male", "Female")) %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line(aes(group = cancer_common, colour = cancer_common))+
geom_smooth()
nhs_borders_select
nhs_borders_select %>%
filter(sex %in% c("Male", "Female")) %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line(aes(group = cancer_common, colour = cancer_common))+
geom_smooth()
nhs_borders_select %>%
filter(cancer_common == "Breast",
sex == "All") %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line()+
geom_smooth()
nhs_borders_select %>%
filter(cancer_common == "Breast",
sex == "All")
nhs_borders_select %>%
filter(cancer_common == "Breast",
sex == "All") %>%
group_by(year) %>%
summarise(total = sum(incidences_all_ages))
nhs_borders_select %>%
filter(cancer_common == "Breast",
sex == "All") %>%
group_by(year) %>%
summarise(total_incidences_breast = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidences_breast))+
geom_point()+
geom_line()+
geom_smooth()
nhs_borders_select %>%
filter(cancer_common == "Breast",
sex == "All") %>%
group_by(year) %>%
summarise(total_incidences_breast = sum(incidences_all_ages))
nhs_borders_select %>%
filter(cancer_common == "Breast",
sex == "All") %>%
group_by(year) %>%
summarise(total_incidences_breast = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidences_breast))+
geom_point()+
geom_line()+
geom_smooth()
nhs_borders_select <- nhs_borders %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung")) %>%
mutate(cancer_common = case_when(
str_detect(cancer_site, "Breast") ~ "Breast",
str_detect(cancer_site, "Carcinoma in situ of the breast") ~ "Breast",
str_detect(cancer_site, "Colon") ~ "Bowel",
str_detect(cancer_site, "Colorectal cancer") ~ "Bowel",
str_detect(cancer_site, "Rectum and rectosigmoid junction") ~ "Bowel",
str_detect(cancer_site, "Prostate") ~ "Prostate",
str_detect(cancer_site, "Mesothelioma") ~ "Lung",
str_detect(cancer_site, "Trachea, bronchus and lung") ~ "Lung"
), .after = cancer_site)
nhs_borders_select %>%
filter(cancer_common == "Bowel",
sex == "All") %>%
group_by(year) %>%
summarise(total_incidences_bowel = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidences_bowel))+
geom_point()+
geom_line()+
geom_smooth()
nhs_borders_select %>%
filter(cancer_common == "Lung",
sex == "All") %>%
group_by(year) %>%
summarise(total_incidences_lung = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidences_lung))+
geom_point()+
geom_line()+
geom_smooth()
nhs_borders_select %>%
filter(cancer_common == "Prostate",
sex == "Male") %>%
group_by(year) %>%
summarise(total_incidences_prostate = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidences_prostate))+
geom_point()+
geom_line()+
geom_smooth()
nhs_borders_select %>%
filter(cancer_common == "Prostate")
nhs_borders_select
nhs_borders_select %>%
filter(cancer_common == "Prostate")
nhs_borders_prostate_recode <- nhs_borders %>%
mutate(sex = recode(sex,
"All" = "Male"))
nhs_borders_prostate_recode
nhs_borders_prostate_recode <- nhs_borders_select %>%
filter(cancer_common == "Prostate") %>%
mutate(sex = recode(sex,
"All" = "Male"))
nhs_borders_prostate_recode
nhs_borders_prostate_recode <- nhs_borders_select %>%
filter(cancer_common == "Prostate") %>%
mutate(sex = recode(sex,
"Male" = "All"))
nhs_borders_prostate_recode
nhs_borders_select <- nhs_borders_select %>%
filter(cancer_common != "Prostate")
nhs_borders_select
nhs_borders_selected <- nhs_borders_select %>%
bind_rows(nhs_borders_prostate_recode)
nhs_borders_selected
nhs_borders_select <- nhs_borders_select %>%
bind_rows(nhs_borders_prostate_recode)
nhs_borders_select
rm(nhs_borders_selected)
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(cancer_common, year) %>%
summarise(total_indicies = sum(incidences_all_ages))
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages))
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_point()+
geom_line(aes(group = cancer_common, colour = cancer_common))
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common))
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "dodge")
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "stack")
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "stack")+
coord_flip()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(total = sum(incidences_all_ages))
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(total_incidies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidies))+
geom_point()+
geom_line(group = 1)+
geom_smooth()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(total_incidies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidies))+
geom_col()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(total_incidies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidies))+
geom_col()+
geom_smooth()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(total_incidies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidies))+
geom_col()+
geom_smooth()+
coord_flip()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(total_incidies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_incidies))+
geom_col()+
geom_smooth()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "stack")+
coord_flip()+
geom_smooth()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "stack")+
coord_flip()
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "stack")+
coord_flip()+
geom_smooth(inherit.aes = TRUE)
nhs_borders_select %>%
filter(sex == "All") %>%
group_by(year, cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = total_indicies)) +
geom_col(aes(fill = cancer_common), position = "stack")+
coord_flip()

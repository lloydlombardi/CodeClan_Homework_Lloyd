filter(sex == "All") %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders\n")
nhs_select %>%
filter(sex == "All") %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland\n")
nhs_borders
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders\n")
nhs_select %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland\n")
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders\n",
subtitle = "Years: 2015 - 2020")
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders",
subtitle = "Years: 2015 - 2020\n")
nhs_select %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland",
subtitle = "Years: 2015 - 2020\n")
nhs_select %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = total_indicies/sum(total_indicies)), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland",
subtitle = "Years: 2015 - 2020\n")
nhs_select %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = round(total_indicies/sum(total_indicies*100), digits = 1), vjust = -0.25))+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland",
subtitle = "Years: 2015 - 2020\n")
nhs_select %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = round(total_indicies/sum(total_indicies)*100, digits = 1), vjust = -0.25))+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland",
subtitle = "Years: 2015 - 2020\n")
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = round(total_indicies/sum(total_indicies)*100, vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders",
subtitle = "Years: 2015 - 2020\n")
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = round(total_indicies/sum(total_indicies)*100), vjust = -0.25)+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders",
subtitle = "Years: 2015 - 2020\n")
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = round(total_indicies/sum(total_indicies)*100), vjust = -0.25))+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders",
subtitle = "Years: 2015 - 2020\n")
nhs_borders %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = paste0(round(total_indicies/sum(total_indicies)*100), "%"), vjust = -0.25))+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Borders",
subtitle = "Years: 2015 - 2020\n")
nhs_select %>%
filter(sex == "All",
year >= 2015) %>%
group_by(cancer_common) %>%
summarise(total_indicies = sum(incidences_all_ages)) %>%
ggplot(aes(x = cancer_common,
y = total_indicies))+
geom_col(aes(fill = cancer_common))+
theme_minimal()+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")+
geom_text(aes(label = paste0(round(total_indicies/sum(total_indicies)*100, digits = 1), "%"), vjust = -0.25))+
labs(x = "\nType of Cancer",
y = "Incidence Rate",
title = "Incidence Rate of Common Cancer Types for All Ages in NHS Scotland",
subtitle = "Years: 2015 - 2020\n")
library(tidyverse)
library(janitor)
library(brew)
incidence <- read_csv("data/incidence_by_hb.csv") %>% clean_names()
hb <- read_csv("data/hb_geography_code.csv") %>% clean_names()
incidence <- incidence %>%
left_join(select(hb, hb_name, hb), by = c("hb" = "hb"), keep = FALSE)
incidence_male <- incidence %>%
filter(cancer_site %in% c("Prostate", "Penis", "Testis")) %>%
mutate(sex = recode(sex,
"Male" = "All"))
incidence <- incidence %>%
filter(cancer_site != "Prostate",
cancer_site != "Penis",
cancer_site != "Testis")
incidence <- incidence %>%
bind_rows(incidence_male)
incidence_female <- incidence %>%
filter(cancer_site %in% c("Carcinoma in situ of the cervix uteri", "Cervix uteri", "Corpus uteri", "Ovary", "Uterus", "Vagina", "Vulva")) %>%
mutate(sex = recode(sex,
"Female" = "All"))
incidence <- incidence %>%
filter(cancer_site != "Carcinoma in situ of the cervix uteri",
cancer_site != "Cervix uteri",
cancer_site != "Corpus uteri",
cancer_site != "Ovary",
cancer_site != "Uterus",
cancer_site != "Vagina",
cancer_site != "Vulva")
incidence <- incidence %>%
bind_rows(incidence_female)
incidence
incidence %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"),
year == 2020)
incidence %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"),
year == 2020,
sex == "All",
hb_name == "NHS Borders")
incidence %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"),
year == 2020,
sex == "All",
hb_name == "NHS Borders") %>%
group_by(year) %>%
summarise(total = sum(incidences_all_ages))
cancer_site
incidence
incidence %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"),
year == 2020,
sex == "All",
hb_name == "NHS Borders")
incidence %>%
filter(sex == "All",
year == 2020,
hb_name == "NHS Borders")
incidence %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung"),
year == 2020,
sex == "All",
hb_name == "NHS Borders") %>%
group_by(year) %>%
summarise(total = sum(incidences_all_ages))
incidence %>%
filter(sex == "All",
year == 2020,
hb_name == "NHS Borders",
cancer_site != "All cancer types")
incidence %>%
filter(sex == "All",
year == 2020,
hb_name == "NHS Borders",
cancer_site != "All cancer types") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages))
incidence %>%
filter(sex == "All",
year == 2020,
hb_name == "NHS Borders") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages))
incidence
incidence %>%
distinct(cancer_site)
incidence %>%
filter(sex == "All",
year == 2020,
hb_name == "NHS Borders") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages))
incidence %>%
filter(sex == "All",
hb_name == "NHS Borders") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages))
incidence %>%
filter(sex == "All",
hb_name == "NHS Borders") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages in NHS Borders\n")
all_scotland %>%
filter(sex == "All") %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
all_scotland <- read_csv("data/all_scotland.csv") %>% clean_names()
scotland_male <- all_scotland %>%
filter(cancer_site %in% c("Prostate", "Penis", "Testis")) %>%
mutate(sex = recode(sex,
"Male" = "All"))
all_scotland <- all_scotland %>%
filter(cancer_site != "Prostate",
cancer_site != "Penis",
cancer_site != "Testis")
all_scotland <- all_scotland %>%
bind_rows(scotland_male)
scotland_female <- all_scotland %>%
filter(cancer_site %in% c("Carcinoma in situ of the cervix uteri", "Cervix uteri", "Corpus uteri", "Ovary", "Uterus", "Vagina", "Vulva")) %>%
mutate(sex = recode(sex,
"Female" = "All"))
all_scotland <- all_scotland %>%
filter(cancer_site != "Carcinoma in situ of the cervix uteri",
cancer_site != "Cervix uteri",
cancer_site != "Corpus uteri",
cancer_site != "Ovary",
cancer_site != "Uterus",
cancer_site != "Vagina",
cancer_site != "Vulva")
all_scotland <- all_scotland %>%
bind_rows(scotland_female)
scotland_select <- all_scotland %>%
filter(cancer_site %in% c("Breast", "Carcinoma in situ of the breast", "Colon", "Colorectal cancer", "Mesothelioma", "Prostate", "Rectum and rectosigmoid junction", "Trachea, bronchus and lung")) %>%
mutate(cancer_common = case_when(
str_detect(cancer_site, "Breast") ~ "Breast",
str_detect(cancer_site, "Carcinoma in situ of the breast") ~ "Breast",
str_detect(cancer_site, "Colon") ~ "Bowel",
str_detect(cancer_site, "Colorectal cancer") ~ "Bowel",
str_detect(cancer_site, "Rectum and rectosigmoid junction") ~ "Bowel",
str_detect(cancer_site, "Prostate") ~ "Prostate",
str_detect(cancer_site, "Mesothelioma") ~ "Lung",
str_detect(cancer_site, "Trachea, bronchus and lung") ~ "Lung"
), .after = cancer_site)
all_scotland %>%
filter(sex == "All") %>%
ggplot(aes(x = year,
y = incidences_all_ages))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
all_scotland %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
all_scotland %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages))
all_scotland %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
all_scotland %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
scale_y_continuous(labels = comma)+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
all_scotland %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
scale_y_continuous(labels = "comma")+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
library(scales)
all_scotland %>%
filter(sex == "All") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
scale_y_continuous(labels = comma)+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
incidence %>%
filter(sex == "All",
hb_name == "NHS Borders",
cancer_site != "All cancer types") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages in NHS Borders\n")
all_scotland %>%
filter(sex == "All",
cancer_site != "All cancer types") %>%
group_by(year) %>%
summarise(n = sum(incidences_all_ages)) %>%
ggplot(aes(x = year,
y = n))+
geom_point()+
geom_line(group = 1)+
geom_smooth()+
scale_y_continuous(labels = comma)+
theme_minimal()+
labs(x = "\nYear",
y = "Incidence Rate",
title = "Incidence Rate of All Cancer Sites for All Ages across NHS Scotland\n")
incidence %>%
distinct(cancer_site)
incidence %>%
distinct(cancer_site) %>%
arrange(cancer_site)

geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(sum_monthly_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = sum_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Total Ride Duration (minutes)",
title = "Total Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(gender) %>%
mutate(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = gender, colour = gender))
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(gender) %>%
mutate(sum_monthly_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = sum_monthly_ride_time)) +
geom_line(aes(group = gender, colour = gender))
library(tidyverse)
library(janitor)
library(tsibble)
library(brew)
library(lubridate)
library(leaflet)
nyc_bikes <- tsibbledata::nyc_bikes %>% clean_names()
glimpse(nyc_bikes)
nyc_bikes %>%
filter(is.na(bike_id:gender))
nyc_bikes %>%
distinct(type)
nyc_bikes %>%
distinct(start_station)
nyc_bikes %>%
distinct(gender)
nyc_bikes <- nyc_bikes %>%
filter(ride_duration <= 600) %>%
mutate(month_of_ride = month(start_time, label = TRUE, abbr = FALSE),
day_of_week_ride = wday(start_time, label = TRUE, abbr = TRUE),
year_of_ride = year(start_time),
date = as_date(start_time),
ride_duration = as.numeric(as.period(stop_time - start_time), "minutes"),
season = case_when(
str_detect(month_of_ride, "December") ~ "Winter",
str_detect(month_of_ride, "January") ~ "Winter",
str_detect(month_of_ride, "February") ~ "Winter",
str_detect(month_of_ride, "March") ~ "Spring",
str_detect(month_of_ride, "April") ~ "Spring",
str_detect(month_of_ride, "May") ~ "Spring",
str_detect(month_of_ride, "June") ~ "Summer",
str_detect(month_of_ride, "July") ~ "Summer",
str_detect(month_of_ride, "August") ~ "Summer",
str_detect(month_of_ride, "September") ~ "Autumn",
str_detect(month_of_ride, "October") ~ "Autumn",
str_detect(month_of_ride, "November") ~ "Autumn",
),
season = factor(season, order = TRUE),
.after = stop_time)
nyc_bikes <- nyc_bikes %>%
mutate(month_of_ride = month(start_time, label = TRUE, abbr = FALSE),
day_of_week_ride = wday(start_time, label = TRUE, abbr = TRUE),
year_of_ride = year(start_time),
date = as_date(start_time),
ride_duration = as.numeric(as.period(stop_time - start_time), "minutes"),
season = case_when(
str_detect(month_of_ride, "December") ~ "Winter",
str_detect(month_of_ride, "January") ~ "Winter",
str_detect(month_of_ride, "February") ~ "Winter",
str_detect(month_of_ride, "March") ~ "Spring",
str_detect(month_of_ride, "April") ~ "Spring",
str_detect(month_of_ride, "May") ~ "Spring",
str_detect(month_of_ride, "June") ~ "Summer",
str_detect(month_of_ride, "July") ~ "Summer",
str_detect(month_of_ride, "August") ~ "Summer",
str_detect(month_of_ride, "September") ~ "Autumn",
str_detect(month_of_ride, "October") ~ "Autumn",
str_detect(month_of_ride, "November") ~ "Autumn",
),
season = factor(season, order = TRUE),
.after = stop_time)
nyc_bikes
nyc_bikes %>%
index_by(year_of_ride) %>%
arrange(desc(ride_duration))
nyc_bikes %>%
index_by(year_of_ride) %>%
arrange(desc(ride_duration)) %>%
head(3)
nyc_bikes <- nyc_bikes
nyc_bikes <- nyc_bikes %>%
filter(ride_duration <= 600)
dow_hires <- nyc_bikes %>%
index_by(day_of_week_ride) %>%
summarise(count = n())
dow_hires %>%
ggplot(aes(x = day_of_week_ride,
y = count)) +
geom_point() +
geom_line(group = 1)
nyc_bikes %>%
mutate(type = factor(type, order = TRUE)) %>%
index_by(type) %>%
summarise(count = n()) %>%
ggplot(aes(x = type,
y = count)) +
geom_col(aes(fill = type),
alpha = 0.8) +
scale_x_discrete(limits = c("Customer", "Subscriber")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
geom_text(aes(label = paste0(round(count / sum(count) * 100, digits = 1), "%")), vjust = -0.25)+
theme_light() +
theme(legend.position = "none") +
labs(x = "\nCustomer Type",
y = "Number of Customers",
title = "Number of Customer Types\n")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#003A72") +
scale_x_log10()
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#DB230B") +
scale_x_log10()
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#003A72") +
scale_x_log10()
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#003A72")
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#003A72") +
scale_x_log10()
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#003A72") +
scale_x_log10() +
theme_light() +
labs(x = "\nRide Duration (minutes)",
y = "Count",
title = "Distribution of Ride Duration\n")
nyc_bikes %>%
index_by(month_of_ride) %>%
summarise(sum_monthly_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = sum_monthly_ride_time)) +
geom_point(colour = "#003A72", size = 2) +
geom_line(group = 1, colour = "#DB230B")+
theme_light() +
labs(x = "\nMonth of Year",
y = "Total Ride Duration (minutes)",
title = "Ride Duration per Month\n")
leaflet(nyc_bikes) %>%
addTiles() %>%
addMarkers(
lng = ~start_long,
lat = ~start_lat,
popup = ~paste("Station:", start_station)
)
nyc_bikes %>%
index_by(month_of_ride) %>%
summarise(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(colour = "#003A72", size = 2) +
geom_line(group = 1, colour = "#DB230B")+
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month\n")
nyc_bikes %>%
mutate(type = factor(type, order = TRUE)) %>%
index_by(type) %>%
summarise(count = n()) %>%
ggplot(aes(x = type,
y = count)) +
geom_col(aes(fill = type),
alpha = 0.8) +
scale_x_discrete(limits = c("Customer", "Subscriber")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
geom_text(aes(label = paste0(round(count / sum(count) * 100, digits = 1), "%")), vjust = -0.25)+
theme_light() +
theme(legend.position = "none") +
labs(x = "\nCustomer Type",
y = "Number of Customers",
title = "Number of Customer Types\n")
nyc_bikes %>%
index_by(season) %>%
group_by(type) %>%
summarise(count = n()) %>%
ggplot(aes(x = season,
y = count)) +
geom_col(aes(fill = type),
alpha = 0.8, position = "dodge") +
scale_x_discrete(limits = c("Spring", "Summer", "Autumn", "Winter")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nSeason",
y = "Number of Bike Rides",
title = "Number of Bike Rides per Season\n",
fill = "Customer Type")
nyc_bikes %>%
index_by(season) %>%
group_by(type) %>%
summarise(sum_season_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = season,
y = sum_season_ride_time)) +
geom_col(aes(fill = type),
alpha = 0.8, position = "dodge") +
scale_x_discrete(limits = c("Spring", "Summer", "Autumn", "Winter")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nSeason",
y = "Total Ride Time (minutes)",
title = "Total Ride Time per Season\n",
fill = "Customer Type")
nyc_bikes %>%
index_by(season) %>%
group_by(type) %>%
summarise(mean_seasonal_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = season,
y = mean_seasonal_ride_time)) +
geom_col(aes(fill = type),
alpha = 0.8,
position = "dodge") +
scale_x_discrete(limits = c("Spring", "Summer", "Autumn", "Winter")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nSeason",
y = "Mean Ride Time (minutes)",
title = "Mean Ride Time per Season\n",
fill = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(sum_monthly_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = sum_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Total Ride Duration (minutes)",
title = "Total Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
filter(ride_duration > 100)
source("~/.active-rstudio-document", echo=TRUE)
library(tidyverse)
library(janitor)
library(tsibble)
library(brew)
library(lubridate)
library(leaflet)
nyc_bikes <- tsibbledata::nyc_bikes %>% clean_names()
glimpse(nyc_bikes)
nyc_bikes %>%
filter(is.na(bike_id:gender))
nyc_bikes %>%
distinct(type)
nyc_bikes %>%
distinct(start_station)
nyc_bikes %>%
distinct(gender)
nyc_bikes <- nyc_bikes %>%
mutate(month_of_ride = month(start_time, label = TRUE, abbr = FALSE),
day_of_week_ride = wday(start_time, label = TRUE, abbr = TRUE),
year_of_ride = year(start_time),
date = as_date(start_time),
ride_duration = as.numeric(as.period(stop_time - start_time), "minutes"),
season = case_when(
str_detect(month_of_ride, "December") ~ "Winter",
str_detect(month_of_ride, "January") ~ "Winter",
str_detect(month_of_ride, "February") ~ "Winter",
str_detect(month_of_ride, "March") ~ "Spring",
str_detect(month_of_ride, "April") ~ "Spring",
str_detect(month_of_ride, "May") ~ "Spring",
str_detect(month_of_ride, "June") ~ "Summer",
str_detect(month_of_ride, "July") ~ "Summer",
str_detect(month_of_ride, "August") ~ "Summer",
str_detect(month_of_ride, "September") ~ "Autumn",
str_detect(month_of_ride, "October") ~ "Autumn",
str_detect(month_of_ride, "November") ~ "Autumn",
),
season = factor(season, order = TRUE),
.after = stop_time)
nyc_bikes
nyc_bikes %>%
index_by(year_of_ride) %>%
arrange(desc(ride_duration)) %>%
head(3)
nyc_bikes <- nyc_bikes %>%
filter(ride_duration <= 600)
nyc_bikes <- nyc_bikes %>%
filter(ride_duration <= 120)
nyc_bikes %>%
ggplot(aes(x = ride_duration)) +
geom_histogram(bins = 100, col = "white", fill = "#003A72") +
scale_x_log10() +
theme_light() +
labs(x = "\nRide Duration (minutes)",
y = "Count",
title = "Distribution of Ride Duration\n")
monthly_hires <- nyc_bikes %>%
index_by(month_of_ride) %>%
summarise(count = n())
monthly_hires %>%
ggplot(aes(x = month_of_ride,
y = count,
label = count)) +
geom_point(colour = "#003A72", size = 2) +
geom_line(group = 1, colour = "#DB230B")+
geom_text(vjust = -0.25, hjust = 1) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Number of Bike Rides",
title = "Number of Bike Rides per Month\n")
nyc_bikes %>%
index_by(month_of_ride) %>%
summarise(sum_monthly_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = sum_monthly_ride_time)) +
geom_point(colour = "#003A72", size = 2) +
geom_line(group = 1, colour = "#DB230B")+
theme_light() +
labs(x = "\nMonth of Year",
y = "Total Ride Duration (minutes)",
title = "Ride Duration per Month\n")
nyc_bikes %>%
index_by(month_of_ride) %>%
summarise(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(colour = "#003A72", size = 2) +
geom_line(group = 1, colour = "#DB230B")+
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month\n")
nyc_bikes %>%
mutate(type = factor(type, order = TRUE)) %>%
index_by(type) %>%
summarise(count = n()) %>%
ggplot(aes(x = type,
y = count)) +
geom_col(aes(fill = type),
alpha = 0.8) +
scale_x_discrete(limits = c("Customer", "Subscriber")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
geom_text(aes(label = paste0(round(count / sum(count) * 100, digits = 1), "%")), vjust = -0.25)+
theme_light() +
theme(legend.position = "none") +
labs(x = "\nCustomer Type",
y = "Number of Customers",
title = "Number of Customer Types\n")
nyc_bikes %>%
index_by(season) %>%
group_by(type) %>%
summarise(count = n()) %>%
ggplot(aes(x = season,
y = count)) +
geom_col(aes(fill = type),
alpha = 0.8, position = "dodge") +
scale_x_discrete(limits = c("Spring", "Summer", "Autumn", "Winter")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nSeason",
y = "Number of Bike Rides",
title = "Number of Bike Rides per Season\n",
fill = "Customer Type")
nyc_bikes %>%
index_by(season) %>%
group_by(type) %>%
summarise(sum_season_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = season,
y = sum_season_ride_time)) +
geom_col(aes(fill = type),
alpha = 0.8, position = "dodge") +
scale_x_discrete(limits = c("Spring", "Summer", "Autumn", "Winter")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nSeason",
y = "Total Ride Time (minutes)",
title = "Total Ride Time per Season\n",
fill = "Customer Type")
nyc_bikes %>%
index_by(season) %>%
group_by(type) %>%
summarise(mean_seasonal_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = season,
y = mean_seasonal_ride_time)) +
geom_col(aes(fill = type),
alpha = 0.8,
position = "dodge") +
scale_x_discrete(limits = c("Spring", "Summer", "Autumn", "Winter")) +
scale_fill_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nSeason",
y = "Mean Ride Time (minutes)",
title = "Mean Ride Time per Season\n",
fill = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(sum_monthly_ride_time = sum(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = sum_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Total Ride Duration (minutes)",
title = "Total Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month by Customer\n",
colour = "Customer Type")
nyc_bikes %>%
index_by(month_of_ride) %>%
group_by(type) %>%
mutate(mean_monthly_ride_time = mean(ride_duration)) %>%
ggplot(aes(x = month_of_ride,
y = mean_monthly_ride_time)) +
geom_point(size = 1) +
geom_line(aes(group = type, colour = type)) +
scale_color_manual(values = c("#003A72", "#DB230B")) +
theme_light() +
labs(x = "\nMonth of Year",
y = "Mean Ride Duration (minutes)",
title = "Mean Ride Duration per Month by Customer\n",
colour = "Customer Type")
leaflet(nyc_bikes) %>%
addTiles() %>%
addMarkers(
lng = ~start_long,
lat = ~start_lat,
popup = ~paste("Station:", start_station)
)
